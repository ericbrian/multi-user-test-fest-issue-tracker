<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Test Fest Tracker</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>

<body>
  <div class="site-header">
    <strong class="site-title">Test Fest Issue Tracker</strong>
    <div id="testProgress" class="test-progress hidden">
      <span class="progress-text">0 of 0 tests done</span>
      <div class="progress-bar">
        <div class="progress-fill"></div>
      </div>
    </div>
    <div class="room-controls">
      <div class="room-selection-area">
        <div id="currentRoomName" class="current-room-name" style="display: none">
          <span class="room-icon">üè† Test Fest:</span>
          <span class="room-name-text"></span>
        </div>
        <label id="roomLabel" for="roomSelect">Room</label>
        <select id="roomSelect"></select>
        <button id="createRoomBtn" title="Create a new Test Fest" aria-label="Create new Test Fest" class="icon-btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M12 5v14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <button id="changeRoomBtn" style="display: none">Change Test Fest</button>
      </div>
    </div>
    <div class="user-controls">
      <div id="loginNote" class="login-note">Log in to start!</div>
      <div id="userInfoHeader" class="user-info"></div>
      <button id="loginBtn" style="display: none">Login</button>
      <button id="logoutBtn" class="btn-danger" style="display: none">
        Logout
      </button>
    </div>
  <div id="authCenter" class="auth-center hidden" aria-hidden="true">
    <div class="auth-card">
      <div class="auth-card-title">Welcome to Test Fest Issue Tracker</div>
      <div class="auth-card-desc">Sign in to join a Test Fest, report issues, and view team issues.</div>
      <div class="auth-card-actions">
        <button id="loginCenterBtn" onclick="window.location.href='/auth/login'">Log in</button>
        <button class="btn-tag" onclick="window.location.href='/auth/login'">Log in</button>
      </div>
    </div>
  </div>
  <!-- Room chooser shown to authenticated users who are not in a room -->
  <div id="roomChooserCenter" class="auth-center hidden" aria-hidden="true">
    <div class="auth-card">
      <div class="auth-card-title">Join or create a Test Fest</div>
      <div class="auth-card-desc">Select an existing room or create a new Test Fest to get started.</div>
      <div class="auth-card-actions" style="width:100%; gap:8px;">
        <select id="roomChooserSelect" style="flex:1; min-width:0; padding:8px 10px; border-radius:8px; border:1px solid var(--border); background:transparent; color:var(--text);">
          <option value="">‚Äî Select a Test ‚Äî</option>
        </select>
        <button id="roomChooserJoinBtn" disabled>Join</button>
      </div>
      <div style="margin-top:12px; display:flex; justify-content:center;">
        <button id="roomChooserCreateBtn" aria-label="Create new Test Fest" class="icon-btn"> 
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M12 5v14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
  </div>
  <div class="layout">
    <div class="left">
      <div class="topbar"></div>
      <div class="left-section">
        <form id="issueForm" class="hidden" style="margin-top: 12px">
          <label for="scriptId">Test Script ID</label>
          <input id="scriptId" name="scriptId" type="number" inputmode="numeric" step="1" min="1" required />

          <label for="description">Issue Description</label>
          <textarea id="description" name="description" rows="4" required></textarea>

          <label>Reason for logging?</label>
          <div class="reasons">
            <label><input type="checkbox" name="is_issue" checked /> New Issue</label>
            <label><input type="checkbox" name="is_existing_upper_env" /> Issue in
              Production</label>
            <label><input type="checkbox" name="is_annoyance" /> Annoyance</label>
            <label><input type="checkbox" name="is_not_sure_how_to_test" /> Not
              sure how to test</label>
          </div>

          <label>Images</label>
          <input id="images" name="images" type="file" accept="image/*" multiple />
          <div class="form-actions">
            <button type="submit">Save Issue</button>
          </div>
        </form>
      </div>
      <!-- left auth placeholder removed; use centered auth/chooser instead -->
    </div>
    <div class="right">
      <h2 class="section-title">All Issues Reported by Team</h2>
      <!-- right auth placeholder removed; use centered auth/chooser instead -->
      <div class="topbar">
        <div id="tagLegend" class="hidden"></div>
      </div>
      <div id="issues" class="hidden"></div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script type="module" src="/static/js/main.js"></script>
</body>

</html>
